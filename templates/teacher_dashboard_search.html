{% extends "base.html" %}
{% block title %}ğŸ” Search Results â€” {{ class_name }}{% endblock %}
{% block content %}
<h2>ğŸ” Search in {{ class_name }}</h2>

<form method="get" action="{{ url_for('teacher_dashboard_bp.search_student') }}" class="mb-3">
  <input type="text" name="q" value="{{ query }}" placeholder="Search by TRNO or Name" class="form-control w-50 d-inline-block">
  <button class="btn btn-primary">Search</button>
  <a href="{{ url_for('teacher_dashboard_bp.dashboard') }}" class="btn btn-secondary ms-2">Back</a>
</form>

{% if results %}
<div class="table-responsive">
  <table class="table table-striped table-sm">
    <thead><tr><th>TRNO</th><th>Name</th><th>Email</th><th>Issues</th><th>Fines Paid</th><th>Report</th></tr></thead>
    <tbody>
      {% for s in results %}
      <tr>
        <td>{{ s.TRNumber }}</td>
        <td>{{ s.FullName }}</td>
        <td>{{ s.EduEmail }}</td>
        <td>{{ s.Issues_AY }}</td>
        <td>{{ "%.2f"|format(s.FinesPaid_AY) }}</td>
        <td><a href="{{ url_for('teacher_dashboard_bp.download_report', scope='student:' ~ s.TRNumber, fmt='pdf') }}" class="btn btn-sm btn-outline-primary">â¬‡ï¸ PDF</a></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<p>No students found.</p>
{% endif %}
{% endblock %}
